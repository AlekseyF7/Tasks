# Модель для предсказания правильных ответов (QA Task)

## Описание

Решение задачи предсказания правильного ответа из множественного выбора с использованием GigaChat API и промпт-инженеринга.

## Особенности решения

1. **Few-shot learning**: Используются примеры из обучающего набора для улучшения качества предсказаний
2. **Улучшенный промпт**: Структурированный промпт с четкими инструкциями
3. **Надежное извлечение ответов**: Множественные стратегии извлечения индекса ответа из текста модели
4. **Обработка ошибок**: Retry механизм с экспоненциальной задержкой
5. **Управление нагрузкой**: Батчевая обработка с задержками для соблюдения лимитов API

## Установка зависимостей

```bash
pip install pandas tqdm gigachat
```

## Подготовка

1. Создайте файл `authGigaChat.txt` с токеном GigaChat API
2. Убедитесь, что файлы `train.csv` и `test.csv` находятся в правильной директории

## Использование

### Быстрый запуск на тестовом наборе

```bash
python run_predictions.py
```

### Запуск с проверкой на обучающем наборе

```bash
python qa_model.py
```

## Структура файлов

- `qa_model.py` - основная логика модели с функциями предсказания
- `run_predictions.py` - скрипт для запуска предсказаний на тестовом наборе
- `submit.csv` - выходной файл с предсказаниями (создается после запуска)

## Формат выходного файла

```csv
id,prediction
0.0,1
1.0,2
2.0,0
...
```

## Параметры настройки

В функции `predict_with_gigachat_improved` можно настроить:

- `max_retries` - максимальное количество попыток при ошибке (по умолчанию: 3)
- `delay_between_requests` - задержка между запросами в секундах (по умолчанию: 0.1)
- `batch_size` - размер батча перед паузой (по умолчанию: 50)
- `delay_between_batches` - задержка после батча в секундах (по умолчанию: 2.0)
- `use_few_shot` - использовать ли few-shot примеры (по умолчанию: True)

## Ожидаемая точность

При использовании улучшенного промпта с few-shot learning ожидается accuracy > 0.85 на тестовом наборе.

