from endings import (
    end_one,
    end_two,
    end_three,
    end_four
)
from characters import Knight
from combat import fight_undead_ambush, fight_dragon

def scene_0_intro(name_hero):
    # ======== СЦЕНА 0: ВВЕДЕНИЕ ==========
    print("Ты стоишь на краю ледяного утёса в Нордсколе.")
    print("За твоей спиной — знамя Альянса. Впереди — мрачная громада Ледяной Короны.")
    print()
    print(f"Ты — Сер {name_hero}, почётный рыцарь Серебряного Авангарда.")
    print("Твой отряд отправлен исследовать залы Ледяной Короны в поисках ценных материалов.")
    print()
    print("Тебя как всегда мучает вопрос: «Что оставил после себя прошлый Король Лич, Артас Менетил?»")
    print("Явно он что-то оставил. Своё наследие...")

def scene_1_sword(player):
    # ====== СЦЕНА 1: МЕЧ ========
    print("Залы Ледяной Короны пусты. Лишь ветер воет в коридорах.")
    print("Но вдруг в одном из коридоров ты находишь потайную дверь...")
    print()
    print("Внутри — ледяной алтарь. На нём — рунический меч, пульсирующий синим светом.")
    print("Рядом — пергамент с почерком...")
    print()
    print('«Сила — не проклятие. Она — испытание.')
    print('Тот, кто возьмёт этот клинок, должен доказать:')
    print('власть может служить, а не разрушать.')
    print('Я не нашёл этого пути. Может, ты найдёшь?»')
    print("— Артас Менетил")
    print()
    choice_one = input("Взять меч? (да/нет): ").strip().lower()
    if choice_one == 'нет':
        player.gain_honor(20)
        end_four()
        exit()
    elif choice_one == 'да':
        player.lich_sword = True
        player.lose_honor(10)
        print("Меч сливается с твоей рукой. Ты чувствуешь холод... и понимание.")

def scene_2_battle_one(player):
    # ======== СЦЕНА 2: ЗАСАДА НЕЖИТИ =========
    print("\nТы покидаешь Ледяную Корону. Ветер режет лицо, как лезвие.")
    print("До лагеря Альянса — два часа пути. Но что-то не так...")
    print("Снег хрустит не под твоими сапогами... а под **костями**.")
    print()
    print("Из-за ледяных глыб выползают **восставшие рыцари** — это нежить Плети!")
    print("Их доспехи ржавые, глаза — пустые, но клинки остры.")
    print('"Убить..." — хрипят они.')
    print()
    # Битва с нежитью
    if fight_undead_ambush(player):
        print("Игра окончена.")
        return

def scene_3_betrayal(name_hero):
    # ======== СЦЕНА 3: ЛАБОРАТОРИЯ КЕЛДРИСА =======
    print("Возвращаясь, ты перехватываешь дозорного Альянса.")
    print("Он шепчет: «Учёные... они воскресили его... Дракона...»")
    print()
    print("Ты проникаешь в тайную лабораторию под Драконьим Пиком.")
    print("Посреди зала — гигантская клетка из рун и льда.")
    print("В ней — САРТОРАКС, Дракон Смерти, чьи чешуйки чёрны, как ночь, а глаза — полны боли.")
    print()
    print("Учёный Келдрис замечает тебя:")
    print(f'"А! Рыцарь {name_hero} ! Сарторакс — наше оружие против Орды!')
    print('С ним Альянс будет непобедим! Что ты здесь делаешь?')
    print()
    print("Ты чувствуешь, как меч Артаса пульсирует: «Он страдает...»")
    print("Ты поднимаешь меч:")
    print('"Ни одно живое существо не станет оружием. Даже ради нашей победы."')
    print()
    print("Келдрис кричит: «Убить предателя!»")
    print("Но ты уже бежишь к клетке...")

def scene_4_battle_two(player):
    # ======= СЦЕНА 4: БИТВА С ДРАКОНОМ =======
    print("Ты разрушаешь руны. Сарторакс вырывается на свободу!")
    print("Но он не благодарен... он яростен. Его разум разорван между болью и яростью.")
    print()
    print("САРТОРАКС: *«СМЕРТЬ... ВСЕМ...»*")
    print("Битва начинается!")
    # Финальная битва
    if not fight_dragon(player):
        print("Игра окончена.")
        return

def scene_5_final():
    # ======= СЦЕНА 5: СУДЬБА ДРАКОНА ======
    print("Дракон смотрит на тебя. Его глаза — не звериные. В них — разум.")
    print()
    print('САРТОРАКС (мысленно): "Убей меня... или дай мне цель..."')
    print()
    print("Что ты сделаешь?")
    print("1. Отдать дракона Альянсу — пусть станет щитом.")
    print("2. Убить дракона — ради свободы мира.")
    print("3. Подчинить его силе Плети — под своим контролем.")
    choice_two = input("Выбери (1/2/3): ").strip()
    if choice_two == "1":
        end_one()
    elif choice_two == "2":
        end_two()
    elif choice_two == "3":
        end_three()